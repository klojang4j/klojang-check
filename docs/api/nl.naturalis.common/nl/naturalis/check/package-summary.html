<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (18) on Fri Sep 30 20:59:01 CEST 2022 -->
<title>nl.naturalis.check</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<meta name="dc.created" content="2022-09-30">
<meta name="description" content="declaration: module: nl.naturalis.common, package: nl.naturalis.check">
<meta name="generator" content="javadoc/PackageWriterImpl">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../../../../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../../../../script-dir/jquery-ui.min.js"></script>
</head>
<body class="package-declaration-page">
<script type="text/javascript">var evenRowColor = "even-row-color";
var oddRowColor = "odd-row-color";
var tableTab = "table-tab";
var activeTableTab = "active-table-tab";
var pathtoroot = "../../../../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li><a href="../../../module-summary.html">Module</a></li>
<li class="nav-bar-cell1-rev">Package</li>
<li>Class</li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html#package">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Package:</p>
<ul>
<li><a href="#package-description">Description</a></li>
<li>Related Packages</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Package:&nbsp;</li>
<li><a href="#package-description">Description</a>&nbsp;|&nbsp;</li>
<li>Related Packages&nbsp;|&nbsp;</li>
<li><a href="#class-summary">Classes and Interfaces</a></li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<div class="sub-title"><span class="module-label-in-package">Module</span>&nbsp;<a href="../../../module-summary.html">nl.naturalis.common</a></div>
<h1 title="Package nl.naturalis.check" class="title">Package nl.naturalis.check</h1>
</div>
<hr>
<div class="package-signature">package <span class="element-name">nl.naturalis.check</span></div>
<section class="package-description" id="package-description">
<div class="block"><p>
 Package dedicated to validating preconditions and postconditions. Precondition
 checks are concerned with validating method arguments, object state, program input
 and other things that must be right before you will even consider continuing with
 code implementing the business logic. Postcondition checks validate computational
 outcomes, possibly stored as intermediate results in local variables. This is what
 such checks would look like with Naturalis Check:

 <blockquote><pre><code>
 this.numChairs = Check.that(numChairs).is(positive()).is(lte(), 4).is(even()).ok();
 </code></pre></blockquote>

 <p>By default, an <code>IllegalArgumentException</code> is thrown if the
 <code>numChairs</code> argument fails any of the three tests in the above statement,
 but this can be customized in various ways (see below).

 <p>Naturalis Check's take on pre- and postcondition validation is different from,
 for example, Guava's <a href="https://guava.dev/releases/21.0/api/docs/com/google/common/base/Preconditions.html">Preconditions</a>
 class and Apache's <a href="https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/Validate.html">Validate</a>
 class. These classes provide static utility methods to validate values. With
 Naturalis Check validation happens through <i>instances</i> of check objects.
 These check objects provide access to various predefined, common checks; they let
 you specify your own checks in the form of lambdas; and they let you chain
 multiple checks on the same value, as the above example illustrates.

 <p>There are two types of check objects:
 <a href="IntCheck.html" title="class in nl.naturalis.check">IntCheck</a>, for validating <code>int</code> values, and
 <a href="ObjectCheck.html" title="class in nl.naturalis.check"><code>ObjectCheck&lt;T&gt;</code></a>, for validating values
 of type <code>&lt;T&gt;</code>. You cannot directly instantiate these classes. You obtain an
 instance of them through the static factory methods on the
 <a href="Check.html" title="class in nl.naturalis.check">Check</a> class. In the example above, the
 <a href="Check.html#that(int)"><code>that</code></a> static factory method returns an
 <code>IntCheck</code> object.






 <h2>Performance</h2>

 <p>Despite the checks being carried out on an actual instance of <code>IntCheck</code>
 or <code>ObjectCheck</code>, benchmarking their performance yields no difference with
 the equivalent hand-coded checks. You can view the results of the JMH benchmarks
 <a href="https://github.com/klojang4j/naturalis-common-jmh/README.md">here</a>.
 Clearly, the JVM has no trouble compiling away the object creation and inlining
 what little remains. Also, the fact that Naturalis Check is heavily based on
 lambdas appears to be no impediment either to a speedy performance. The time that
 lambdas were more sluggish than statically invoked code, if there ever was such a
 time, has long gone.






 <h2>Common Checks</h2>

 <p>Naturalis Check provides a grab bag of common checks on arguments in the form
 of the <a href="CommonChecks.html" title="class in nl.naturalis.check"><code>CommonChecks</code></a> class. The
 <code>lte()</code>, <code>positive()</code> and <code>even()</code> checks shown above are in
 fact static imports from this class. Here are some more examples:

 <blockquote> <pre><code>
 Check.that(obj, "vehicle").is(instanceOf(), Car.class);
 Check.that(list).isNot(empty());
 Check.that(word).is(keyIn(), dictionary); // a Map instance
 Check.that(dictionary).is(containingKey(), word);
 Check.that(file).is(writable());
 </code></pre></blockquote>
 <p>
 These checks are associated with predefined error messages, so you don't need to
 invent them yourself. The first of the above statements, for example, would cause
 the following error message to be generated if the argument were an instance of
 <code>Bike</code>:

 <blockquote> <pre><code>
 "vehicle must be instance of Car (was Bike)"
 </code></pre></blockquote>





 <h2>Types of Checks</h2>
 <p>
 The checks you pass to the <code>is(...)</code> methods fall apart in two broad
 categories: implementations of <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/function/Predicate.html" title="class or interface in java.util.function" class="external-link"><code>Predicate</code></a> and
 <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/function/IntPredicate.html" title="class or interface in java.util.function" class="external-link"><code>IntPredicate</code></a> on the one hand, and implementations of
 <a href="../common/function/Relation.html" title="interface in nl.naturalis.common.function"><code>Relation</code></a> and its sister interfaces on the
 other. The latter are not part of the JDK. They can be thought of as a
 "BiPredicate" (which neither exists in the JDK): a function that takes <i>two</i>
 arguments and returns a boolean. If the two arguments have a particular relation,
 defined by the implementation, to each other, the relation is said to <i>exist</i>
 and the function returns <code>true</code>. Within the context of Naturalis Check, the
 first argument is always the value to be validated, while the second argument is
 the value that it is to be validated against. In the examples above,
 <a href="CommonChecks.html#positive()">positive()</a>,
 <a href="CommonChecks.html#even()">even()</a>,
 <a href="CommonChecks.html#empty()">empty()</a> and
 <a href="CommonChecks.html#writable()">writable()</a> are checks
 implemented as a <code>Predicate</code> or <code>IntPredicate</code>;
 <a href="CommonChecks.html#lte()">lte()</a>,
 <a href="CommonChecks.html#instanceOf()">instanceOf()</a>,
 <a href="CommonChecks.html#keyIn()">keyIn()</a> and
 <a href="CommonChecks.html#containingKey()">containingKey()</a> are
 checks implemented as a <code>Relation</code> or one of its sister interfaces. For more
 information, see the package description of
 <a href="../common/function/package-summary.html">nl.naturalis.common.function</a>.






 <h2>Dealing with Validation Errors</h2>
 <p>
 These two types of checks can again be executed in three different ways: one where
 Naturalis Check generates both the exception and the exception message; one where
 Naturalis Check generates the exception and you provide the exception message; and
 one where you do both. The following code snippet provides an example of each of
 the three variants:

 <blockquote><pre><code>
 Check.that(obj, "vehicle").is(instanceOf(), Car.class);
 Check.that(obj).is(instanceOf(), Car.class, "Bikes are not for rent here");
 Check.that(obj).is(instanceOf(), Car.class, () -&gt; new RentalException("Bikes are not for rent here"));
 </code></pre></blockquote>






 <h2>Custom Error Messages</h2>
 <p>
 If you prefer to send out a custom error message, you can do so by specifying a
 message pattern and zero or more message arguments. The first message argument can
 be referenced from within the message pattern as <code>${0}</code>, the second as
 <code>${1}</code>, etc. For example:

 <blockquote><pre><code>
 Check.that(word).is(keyIn(), dictionary, "Spelling error. Did you mean: \"${0}\"?", "Pterodactylus");
 </code></pre></blockquote>

 <p>The following message arguments are automatically available within the message
 pattern:

 <ol>
   <li><b><code>${test}</code></b> The name of the check that was executed.
      E.g. "lt" or "instanceOf" or "notNull".
   <li><b><code>${arg}</code></b> The value being validated.
   <li><b><code>${type}</code></b> The simple class name of the value.
   <li><b><code>${name}</code></b> The name of the parameter, field or variable
      being validated, or, possibly, something more descriptive (like "vehicle" in
      one of the above examples). Providing a name can be useful when validating
      multiple arguments and/or variables within the same method, as it makes it
      immediately clear which one of them was to blame for the <code>Exception</code>
      emanating from that method. If you do not provide a name, <code>${name}</code>
      defaults to "argument".
   <li><b><code>${obj}</code></b> The object of the relationship, in case the
      check took the form of a
      <a href="../common/function/Relation.html" title="interface in nl.naturalis.common.function">Relation</a> or one of its sister
      interfaces. For example, for the
      <a href="CommonChecks.html#instanceOf()">instanceOf()</a> check,
      <code>${obj}</code> would be the class that the argument must be an instance
      of (<code>Car.class</code> in the example above). For checks expressed
      through a <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/function/Predicate.html" title="class or interface in java.util.function" class="external-link">Predicate</a> or
      <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/function/IntPredicate.html" title="class or interface in java.util.function" class="external-link">IntPredicate</a>, ${obj} will be <code>null</code>.
 </ol>
 <p>
 Here is an example where you don't provide any message arguments yourself, yet
 still have a dynamically generated error message:

 <blockquote><pre><code>
 Check.that(word).is(keyIn(), dictionary, "Missing key \"${arg}\" in map ${obj}");
 </code></pre></blockquote>
 <p>
 Note that message arguments are not stringified using
 <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/Objects.html#toString(java.lang.Object)" title="class or interface in java.util" class="external-link"><code>Objects.toString</code></a> but using
 <a href="../common/StringMethods.html#toShortString(java.lang.Object,int)"><code>StringMethods.toShortString</code></a>.





 <h2>Chaining Checks</h2>
 <p>
 You can apply multiple checks on the same value using a fluent API, as the very
 first example already illustrated:

 <blockquote><pre><code>
 Check.that(numChairs).is(positive()).is(lte(), 4).is(even());
 </code></pre></blockquote>
 <p>
 In a similar manner, you can also chain checks on <i>different values</i>. This
 can make for a very concise argument validation section:

 <blockquote><pre><code>
 Check.that(from).is(gte(), 0).and(to).is(gte(), from).and(list.size()).is(gte(), to);
 </code></pre></blockquote>






 <h2>Validating Argument Properties</h2>

 <p>Naturalis Check lets you validate not just arguments, but also argument
 <i>properties</i>:

 <blockquote><pre><code>
 this.query = Check.that(query, "query")
  .notHas(Query::getOffset, "offset", negative())
  .has(Query::getLimit, "limit", gte(), 10)
  .has(Query::getLimit, "limit", lt(), 10000)
  .ok();
 </code></pre></blockquote>

 <p>The <a href="CommonProperties.html" title="class in nl.naturalis.check">CommonProperties</a> class provides some
 commonly used properties of well-known classes and interfaces, like the
 <code>size</code> property of a <code>Collection</code>. As with the <code>CommonChecks</code>
 class, these properties are already associated with a descriptive name of the
 property they expose. Thus, the error message to be generated requires minimal
 input from you:

 <blockquote><pre><code>
 Check.notNull(emps, "employees").has(size(), gte(), 100);
 </code></pre></blockquote>

 <p>This will cause the following error message to be generated if the size of the
 <code>emps</code> collection is less than 100:

 <blockquote><pre><code>
 "employees.size() must be &gt;= 100 (was 42)"
 </code></pre></blockquote>

 <p>Note that the term "property" is, in fact, somewhat misleading. This first
 argument to the <b><code>has</code></b> and <b><code>notHas</code></b> methods simply is a
 <code>Function</code> that takes the value being validated and produces some other
 value, which is then also validated. Thus, the <code>CommonProperties</code> class also
 contains, for example, an
 <a href="CommonProperties.html#abs()">abs()</a> function, which
 returns the absolute value of an <code>int</code> value.






 <h2 id="custom-checks">Custom Checks</h2>

 <p>You are not limited to using the checks from the <code>CommonChecks</code> class.
 You can also define your own checks in the form of lambdas or method references:

 <blockquote><pre><code>
 double angle = 45.0;
 Check.that(angle).is(a -&gt; Math.sin(a) &gt; 0, "sine of angle must be positive");
 </code></pre></blockquote>
 <p>
 Be careful, however, when passing lambdas to the <code>has</code> and <code>notHas</code>
 methods. These methods are heavily overloaded. Therefore, "vanilla" lambdas
 (without any type information) may cause the compiler to complain about an
 <b>Ambiguous method call</b>:

 <blockquote><pre><code>
 // WON'T COMPILE! Ambiguous method call
 Check.that(temperature).has(i -&gt; Math.abs(i), i -&gt; i &lt; 30);
 </code></pre></blockquote>

 <p>You can disambiguate this for the compiler by specifying the type of the
 lambda parameter, or by casting the entire lambda or method reference. Any of the
 following statements will do:

 <blockquote><pre><code>
 Check.that(temperature).has(i -&gt; Math.abs(i), (int i) -&gt; i &lt; 30);
 Check.that(temperature).has((IntUnaryOperator) i -&gt; Math.abs(i), i -&gt; i &lt; 30);
 Check.that(temperature).has(i -&gt; Math.abs(i), (Integer i) -&gt; i % 2 == 1);
 Check.that(temperature).has((IntFunction&lt;Integer&gt;) i -&gt; Math.abs(i), i -&gt; i &lt; 30);
 Check.that(temperature).has(abs(), i -&gt; i &lt; 30);
 Check.that(temperature).has(i -&gt; Math.abs(i), lt(), 30);
 Check.that(temperature).has(abs(), lt(), 30);
 </code></pre></blockquote>






 <h2>Throwing a Different Type of Exception</h2>

 <p>By default, Naturalis Check throws an <code>IllegalArgumentException</code> if any
 of the tests following <code>Check.that(...)</code> fail. To customize this, use the
 <b><code>Check.on(...)</code></b> static factory methods instead. These allow you to
 specify an alternative exception. You can also override the default exception
 within the checks themselves. The following example changes the default exception
 to <code>SQLException</code>, but overrides it for the null check:

 <blockquote><pre><code>
 this.query = Check.on(SQLException::new, query, "query")
  .is(notNull(), () -&gt; new NullPointerException())
  .notHas(Query::getOffset, "offset", negative())
  .has(Query::getLimit, "limit", gte(), 10)
  .has(Query::getLimit, "limit", lte(), 10000)
  .ok();
 </code></pre></blockquote>

 <p>Here, too, Naturalis Check provides some useful shortcuts through the
 <a href="CommonExceptions.html" title="class in nl.naturalis.check">CommonExceptions</a> class:

 <blockquote><pre><code>
 Check.that(word)
  .is(notNull(), NPE())
  .is(keyIn(), dictionary, illegalState("no such word: \"" + word + "\"");
 </code></pre></blockquote>

 <p>Note that when you supply your own exception, you cannot use the
 <code>${...}</code> message arguments. You will have to construct the message
 yourself.






 <h2>Returning the Validated Value</h2>

 <p>You can call <a href="ObjectCheck.html#ok()">ok()</a> on
 <code>IntCheck</code> and <code>ObjectCheck</code> if you want to immediately assign the
 validated value to an instance field or local variable. You can optionally pass a
 function to the <code>ok()</code> method that applies some sort of transformation to
 the validated value:

 <blockquote>

 <pre><code>
 Car car = Check.that(obj).is(instanceOf(), Car.class).ok(Class::cast);
 </code></pre>

 </blockquote></div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<div id="class-summary">
<div class="table-tabs" role="tablist" aria-orientation="horizontal"><button id="class-summary-tab0" role="tab" aria-selected="true" aria-controls="class-summary.tabpanel" tabindex="0" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary', 2)" class="active-table-tab">All Classes and Interfaces</button><button id="class-summary-tab2" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab2', 2)" class="table-tab">Classes</button><button id="class-summary-tab5" role="tab" aria-selected="false" aria-controls="class-summary.tabpanel" tabindex="-1" onkeydown="switchTab(event)" onclick="show('class-summary', 'class-summary-tab5', 2)" class="table-tab">Exception Classes</button></div>
<div id="class-summary.tabpanel" role="tabpanel">
<div class="summary-table two-column-summary" aria-labelledby="class-summary-tab0">
<div class="table-header col-first">Class</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="Check.html" title="class in nl.naturalis.check">Check</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Provides static factory methods for <a href="IntCheck.html" title="class in nl.naturalis.check"><code>IntCheck</code></a> and <a href="ObjectCheck.html" title="class in nl.naturalis.check"><code>ObjectCheck</code></a>
 instances.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="CommonChecks.html" title="class in nl.naturalis.check">CommonChecks</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Defines various common checks on arguments, variables, object state, etc.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="CommonExceptions.html" title="class in nl.naturalis.check">CommonExceptions</a></div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Provides factories for some commonly thrown exceptions.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab2"><a href="CommonProperties.html" title="class in nl.naturalis.check">CommonProperties</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab2">
<div class="block">Defines various functions that can optionally be passed as the first argument to
 the <code>has(...)</code> and <code>notHas(...) </code> methods of <a href="IntCheck.html" title="class in nl.naturalis.check"><code>IntCheck</code></a> and
 <a href="ObjectCheck.html" title="class in nl.naturalis.check"><code>ObjectCheck</code></a>.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="IntCheck.html" title="class in nl.naturalis.check">IntCheck</a>&lt;E extends <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a>&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Facilitates the validation of <code>int</code> values.</div>
</div>
<div class="col-first odd-row-color class-summary class-summary-tab5"><a href="InvalidCheckException.html" title="class in nl.naturalis.check">InvalidCheckException</a></div>
<div class="col-last odd-row-color class-summary class-summary-tab5">
<div class="block">Thrown if a check on an argument was not correctly specified.</div>
</div>
<div class="col-first even-row-color class-summary class-summary-tab2"><a href="ObjectCheck.html" title="class in nl.naturalis.check">ObjectCheck</a>&lt;T,<wbr>E extends <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/lang/Exception.html" title="class or interface in java.lang" class="external-link">Exception</a>&gt;</div>
<div class="col-last even-row-color class-summary class-summary-tab2">
<div class="block">Facilitates the validation of arbitrarily typed values.</div>
</div>
</div>
</div>
</div>
</li>
</ul>
</section>
</main>
</div>
</div>
</body>
</html>
