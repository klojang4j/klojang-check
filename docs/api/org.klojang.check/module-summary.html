<!DOCTYPE HTML>
<html lang="en">
<head>
<!-- Generated by javadoc (18) on Tue Oct 25 19:50:18 CEST 2022 -->
<title>org.klojang.check (Klojang Check! 1.0.2 API)</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="dc.created" content="2022-10-25">
<meta name="description" content="declaration: module: org.klojang.check">
<meta name="generator" content="javadoc/ModuleWriterImpl">
<link rel="stylesheet" type="text/css" href="../stylesheet.css" title="Style">
<link rel="stylesheet" type="text/css" href="../script-dir/jquery-ui.min.css" title="Style">
<link rel="stylesheet" type="text/css" href="../jquery-ui.overrides.css" title="Style">
<script type="text/javascript" src="../script.js"></script>
<script type="text/javascript" src="../script-dir/jquery-3.5.1.min.js"></script>
<script type="text/javascript" src="../script-dir/jquery-ui.min.js"></script>
</head>
<body class="module-declaration-page">
<script type="text/javascript">var pathtoroot = "../";
loadScripts(document, 'script');</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<div class="flex-box">
<header role="banner" class="flex-header">
<nav role="navigation">
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="top-nav" id="navbar-top"><button id="navbar-toggle-button" aria-controls="navbar-top" aria-expanded="false" aria-label="Toggle navigation links"><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span><span class="nav-bar-toggle-icon"></span></button>
<div class="skip-nav"><a href="#skip-navbar-top" title="Skip navigation links">Skip navigation links</a></div>
<ul id="navbar-top-firstrow" class="nav-list" title="Navigation">
<li class="nav-bar-cell1-rev">Module</li>
<li>Package</li>
<li>Class</li>
<li>Use</li>
<li><a href="../overview-tree.html">Tree</a></li>
<li><a href="../index-all.html">Index</a></li>
<li><a href="../help-doc.html#module">Help</a></li>
</ul>
<ul class="sub-nav-list-small">
<li>
<p>Module:</p>
<ul>
<li><a href="#module-description">Description</a></li>
<li>Modules</li>
<li><a href="#packages-summary">Packages</a></li>
<li>Services</li>
</ul>
</li>
</ul>
</div>
<div class="sub-nav">
<div id="navbar-sub-list">
<ul class="sub-nav-list">
<li>Module:&nbsp;</li>
<li><a href="#module-description">Description</a>&nbsp;|&nbsp;</li>
<li>Modules&nbsp;|&nbsp;</li>
<li><a href="#packages-summary">Packages</a>&nbsp;|&nbsp;</li>
<li>Services</li>
</ul>
</div>
<div class="nav-list-search"><label for="search-input">SEARCH:</label>
<input type="text" id="search-input" disabled placeholder="Search">
<input type="reset" id="reset-button" disabled value="reset">
</div>
</div>
<!-- ========= END OF TOP NAVBAR ========= -->
<span class="skip-nav" id="skip-navbar-top"></span></nav>
</header>
<div class="flex-content">
<main role="main">
<div class="header">
<h1 title="Module org.klojang.check" class="title">Module org.klojang.check</h1>
</div>
<hr>
<div class="module-signature">module <span class="element-name">org.klojang.check</span></div>
<section class="module-description" id="module-description">
<!-- ============ MODULE DESCRIPTION =========== -->
<div class="block"><p>Klojang Check is a light-weight Java module that provides a concise and
 convenient way of validating preconditions and postconditions.

 <p>Precondition checks are concerned with validating method arguments, object
 state, program input and other things that must be right before you will even
 consider continuing with code implementing the business logic. Postcondition
 checks validate computational outcomes, possibly stored as intermediate results in
 local variables. This is what such checks would look like with Klojang Check:

 <blockquote><pre><code>
 this.numChairs = Check.that(numChairs).is(positive()).is(lte(), 4).is(even()).ok();
 </code></pre></blockquote>

 <p>By default, an <code>IllegalArgumentException</code> is thrown if the
 <code>numChairs</code> argument fails any of the three tests in the above statement,
 but this can be customized in various ways (see below).

 <p>Klojang Check's take on pre- and postcondition validation is different from,
 for example, Guava's <a href="https://guava.dev/releases/21.0/api/docs/com/google/common/base/Preconditions.html">Preconditions</a>
 class and Apache's <a href="https://commons.apache.org/proper/commons-lang/apidocs/org/apache/commons/lang3/Validate.html">Validate</a>
 class. These classes provide static utility methods to validate values. With
 Klojang Check validation happens through <i>instances</i> of check objects. These
 check objects provide access to various predefined, common checks; they let you
 specify your own checks in the form of lambdas; and they let you chain multiple
 checks on the same value, as the above example illustrates.

 <p>There are two types of check objects:
 <a href="org/klojang/check/IntCheck.html" title="class in org.klojang.check">IntCheck</a>, for validating <code>int</code>
 values, and <a href="org/klojang/check/ObjectCheck.html" title="class in org.klojang.check"><code>ObjectCheck&lt;T&gt;</code></a>, for
 validating values of type <code>&lt;T&gt;</code>. You cannot directly instantiate these
 classes. You obtain an instance of them through the static factory methods on the
 <a href="org/klojang/check/Check.html" title="class in org.klojang.check">Check</a> class. In the example above, the
 <a href="org/klojang/check/Check.html#that(int)"><code>that()</code></a> static factory method returns an
 <code>IntCheck</code> object.






 <h2>Performance</h2>

 <p>Despite the checks being carried out on an actual instance of <code>IntCheck</code>
 or <code>ObjectCheck</code>, benchmarking their performance yields no difference with
 the equivalent hand-coded checks. You can view the results of the JMH benchmarks
 <a href="https://github.com/klojang4j/naturalis-common-jmh/README.md">here</a>.
 Clearly, the JVM has no trouble compiling away the object creation and inlining
 what little remains. Also, the fact that Klojang Check is heavily based on lambdas
 appears to be no impediment either to a speedy performance. The time that lambdas
 were more sluggish than statically invoked code, if there ever was such a time,
 has long gone.






 <h2>Common Checks</h2>

 <p>Klojang Check provides a grab bag of common checks on arguments and other
 types of values in the form of the
 <a href="org/klojang/check/CommonChecks.html" title="class in org.klojang.check"><code>CommonChecks</code></a> class. The <code>lte()</code>,
 <code>positive()</code> and <code>even()</code> checks shown above are in fact static
 imports from this class. Here are some more examples:

 <blockquote> <pre><code>
 Check.that(obj, "vehicle").is(instanceOf(), Car.class);
 Check.that(list).isNot(empty());
 Check.that(word).is(keyIn(), dictionary); // a Map instance
 Check.that(dictionary).is(containsKey(), word);
 Check.that(file).is(writable());
 </code></pre></blockquote>
 <p>
 These checks are associated with predefined error messages, so you don't need to
 invent them yourself. The first of the above statements, for example, would cause
 the following error message to be generated if the argument were an instance of
 <code>Bike</code>:

 <blockquote> <pre><code>
 "vehicle must be instance of Car (was Bike)"
 </code></pre></blockquote>





 <h2>Types of Checks</h2>

 <p>The checks you pass to the <code>is(...)</code> methods fall apart in two broad
 categories: implementations of <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/function/Predicate.html" title="class or interface in java.util.function" class="external-link"><code>Predicate</code></a> and
 <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/function/IntPredicate.html" title="class or interface in java.util.function" class="external-link"><code>IntPredicate</code></a> on the one hand, and
 implementations of <a href="org/klojang/check/relation/Relation.html" title="interface in org.klojang.check.relation"><code>Relation</code></a> and its
 sister interfaces on the other. The latter are not part of the JDK. They can be
 thought of as a "BiPredicate" (which neither exists in the JDK): a function that
 takes <i>two</i> arguments and returns a boolean. If the two arguments have a
 particular relationship, defined by the implementation, with each other, the
 relation is said to <i>exist</i> and the function returns <code>true</code>. Within the
 context of Klojang Check, the first argument is always the value to be validated,
 while the second argument is the value that it is to be validated against. In the
 examples above, <a href="org/klojang/check/CommonChecks.html#positive()">positive()</a>,
 <a href="org/klojang/check/CommonChecks.html#even()">even()</a>,
 <a href="org/klojang/check/CommonChecks.html#empty()">empty()</a> and
 <a href="org/klojang/check/CommonChecks.html#writable()">writable()</a> are checks
 implemented as a <code>Predicate</code> or <code>IntPredicate</code>;
 <a href="org/klojang/check/CommonChecks.html#lte()">lte()</a>,
 <a href="org/klojang/check/CommonChecks.html#instanceOf()">instanceOf()</a>,
 <a href="org/klojang/check/CommonChecks.html#keyIn()">keyIn()</a> and
 <a href="org/klojang/check/CommonChecks.html#containsKey()">containsKey()</a> are checks
 implemented as a <a href="org/klojang/check/relation/Relation.html" title="interface in org.klojang.check.relation"><code>Relation</code></a>,
 <a href="org/klojang/check/relation/IntRelation.html" title="interface in org.klojang.check.relation"><code>IntRelation</code></a> or
 <a href="org/klojang/check/relation/IntObjRelation.html" title="interface in org.klojang.check.relation"><code>IntObjRelation</code></a>. For more
 information, see the package description of
 <a href="org/klojang/check/relation/package-summary.html">org.klojang.check.relation</a>.






 <h2>Dealing with Validation Errors</h2>
 <p>
 These two types of checks can again be executed in three different ways: one where
 Klojang Check generates both the exception and the exception message; one where
 Klojang Check generates the exception and you provide the exception message; and
 one where you do both. The following code snippet provides an example of each of
 the three variants:

 <blockquote><pre><code>
 Check.that(obj, "vehicle").is(instanceOf(), Car.class);
 Check.that(obj).is(instanceOf(), Car.class, "Bikes are not for rent here");
 Check.that(obj).is(instanceOf(), Car.class, () -&gt; new RentalException("Bikes are not for rent here"));
 </code></pre></blockquote>






 <h2 id="custom-error-messages">Custom Error Messages</h2>

 <p> If you prefer to emit a custom error message, you can do so by specifying a
 message pattern and zero or more message arguments. The first message argument can
 be referenced from within the message pattern as <code>${0}</code>, the second as
 <code>${1}</code>, etc. For example:

 <blockquote><pre><code>
 Check.that(word).is(keyIn(), dictionary, "Spelling error. Did you mean: \"${0}\"?", "Pterodactylus");
 </code></pre></blockquote>

 <p>The following message arguments are automatically available within the message
 pattern:

 <ol>
   <li><b><code>${test}</code></b> The name of the check that was executed, like
      "lt" or "instanceOf" or "notNull".
   <li><b><code>${arg}</code></b> The value being validated.
   <li><b><code>${type}</code></b> The simple class name of the value.
   <li><b><code>${name}</code></b> The name of the parameter, field or variable
      being validated, or, possibly, something more descriptive (like "vehicle" in
      one of the above examples). Providing a name can be useful when validating
      multiple arguments and/or variables within the same method, as it makes it
      immediately clear which one of them was to blame for the exception. If you
      do not provide a name, <code>${name}</code> defaults to "argument".
   <li><b><code>${obj}</code></b> The object of the relationship, in case the
      check took the form of a
      <a href="org/klojang/check/relation/Relation.html" title="interface in org.klojang.check.relation">Relation</a> or one of its
      sister interfaces. For example, for the
      <a href="org/klojang/check/CommonChecks.html#instanceOf()">instanceOf()</a> check,
      <code>${obj}</code> would be the class that the argument must be an instance
      of (<code>Car.class</code> in the example above). For checks expressed
      through a <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/function/Predicate.html" title="class or interface in java.util.function" class="external-link">Predicate</a> or
      <a href="https://docs.oracle.com/en/java/javase/18/docs/api/java.base/java/util/function/IntPredicate.html" title="class or interface in java.util.function" class="external-link">IntPredicate</a>, ${obj} will be
      <code>null</code>.
 </ol>
 <p>
 Here is an example where you don't provide any message arguments yourself, yet
 still have a dynamically generated error message:

 <blockquote><pre><code>
 Check.that(word).is(keyIn(), dictionary, "Missing key \"${arg}\" in ${obj}");
 </code></pre></blockquote>

 <h3>Suppressing Message Parsing</h3>

 <p>The varargs array used to specify the message arguments (invariably called
 <code>msgArgs</code>) is explicitly allowed to be <code>null</code>. This is taken as a
 signal that the message does not contain any message arguments and should be
 passed as-is to the exception's constructor. You can use this if performance is
 critical, even in anomalous situations. Note, however, that while this does make
 your code look uglier, the performance gain it yields is minimal. It will, in
 fact, only become noticeable if the involved test fails almost continuously. That
 should probably more cause for concern than the speed with which the exception is
 generated.


 <h2>Chaining Checks</h2>

 <p> You can apply multiple checks on the same value using a fluent API, as the
 very first example already illustrated:

 <blockquote><pre><code>
 Check.that(numChairs).is(positive()).is(lte(), 4).is(even());
 </code></pre></blockquote>

 <p>In a similar manner, you can also chain checks on <i>different values</i>. This
 can make for a very concise argument validation section:

 <blockquote><pre><code>
 Check.that(from).is(gte(), 0).and(to).is(gte(), from).and(list.size()).is(gte(), to);
 </code></pre></blockquote>






 <h2>Validating Argument Properties</h2>

 <p>Klojang Check lets you validate not just arguments, but also argument
 <i>properties</i>:

 <blockquote><pre><code>
 this.query = Check.that(query, "query")
  .notHas(Query::getOffset, "offset", negative())
  .has(Query::getLimit, "limit", gte(), 10)
  .has(Query::getLimit, "limit", lt(), 10000)
  .ok();
 </code></pre></blockquote>

 <p>The <a href="org/klojang/check/CommonProperties.html" title="class in org.klojang.check">CommonProperties</a> class
 provides some commonly used properties of well-known classes and interfaces, like
 the <code>size</code> property of a <code>Collection</code>. As with the
 <code>CommonChecks</code> class, these properties are already associated with a
 descriptive name of the property they expose. Thus, the error message to be
 generated requires minimal input from you:

 <blockquote><pre><code>
 Check.notNull(emps, "employees").has(size(), gte(), 100);
 </code></pre></blockquote>

 <p>This will cause the following error message to be generated if the size of the
 <code>emps</code> collection is less than 100:

 <blockquote><pre><code>
 "employees.size() must be &gt;= 100 (was 42)"
 </code></pre></blockquote>

 <p>Note that the term "property" is somewhat misleading. This first argument to
 the <code>has()</code> and <code>notHas()</code> methods simply is a function that takes
 the value being validated and produces some other value, which is then also
 validated. Thus, the <code>CommonProperties</code> class also contains, for example,
 an <a href="org/klojang/check/CommonProperties.html#abs()">abs()</a> function, which
 returns the absolute value of an <code>int</code> value.






 <h2 id="custom-checks">Custom Checks</h2>

 <p>You are not limited to using the checks from the <code>CommonChecks</code> class.
 You can also define your own checks in the form of lambdas or method references:

 <blockquote><pre><code>
 double angle = 45.0;
 Check.that(angle).is(a -&gt; Math.sin(a) &gt; 0, "sine of angle must be positive");
 </code></pre></blockquote>

 <p>Be careful, however, when passing lambdas to the <code>has</code> and <code>notHas</code>
 methods. These methods are heavily overloaded. Therefore, "vanilla" lambdas
 (without any type information) may cause the compiler to complain about an
 <b>Ambiguous method call</b>:

 <blockquote><pre><code>
 // WON'T COMPILE! Ambiguous method call
 Check.that(temperature).has(i -&gt; Math.abs(i), i -&gt; i &lt; 30);
 </code></pre></blockquote>

 <p>You can disambiguate this for the compiler by specifying the type of the
 lambda parameter, or by casting the entire lambda or method reference. Any of the
 following statements will do:

 <blockquote><pre><code>
 Check.that(temperature).has(i -&gt; Math.abs(i), (int i) -&gt; i &lt; 30);
 Check.that(temperature).has((IntUnaryOperator) i -&gt; Math.abs(i), i -&gt; i &lt; 30);
 Check.that(temperature).has(i -&gt; Math.abs(i), (Integer i) -&gt; i % 2 == 1);
 Check.that(temperature).has((IntFunction&lt;Integer&gt;) i -&gt; Math.abs(i), i -&gt; i &lt; 30);
 Check.that(temperature).has(abs(), i -&gt; i &lt; 30);
 Check.that(temperature).has(i -&gt; Math.abs(i), lt(), 30);
 Check.that(temperature).has(abs(), lt(), 30);
 </code></pre></blockquote>






 <h2>Throwing a Different Type of Exception</h2>

 <p>By default, Klojang Check throws an <code>IllegalArgumentException</code> if any
 of the tests following <code>Check.that(...)</code> fail. To customize this, use the
 <code>Check.on(...)</code> static factory methods instead. These allow you to
 change the default exception. The default exception can itself be overridden
 within the checks themselves. The following example changes the default exception
 to <code>SQLException</code>, but overrides it for the null check:

 <blockquote><pre><code>
 this.query = Check.on(SQLException::new, query, "query")
  .is(notNull(), () -&gt; new NullPointerException())
  .notHas(Query::getOffset, "offset", negative())
  .has(Query::getLimit, "limit", gte(), 10)
  .has(Query::getLimit, "limit", lte(), 10000)
  .ok();
 </code></pre></blockquote>

 <p>Here, too, Klojang Check provides some useful shortcuts through the
 <a href="org/klojang/check/CommonExceptions.html" title="class in org.klojang.check">CommonExceptions</a> class:

 <blockquote><pre><code>
 Check.that(word)
  .is(notNull(), NPE())
  .is(keyIn(), dictionary, illegalState("no such word: \"" + word + "\"");
 </code></pre></blockquote>

 <p>Note that when you supply your own exception, you cannot use the
 <code>${...}</code> message arguments. You will have to construct the message
 yourself.






 <h2>Returning the Validated Value</h2>

 <p>You can call <a href="org/klojang/check/ObjectCheck.html#ok()">ok()</a> on
 <code>IntCheck</code> and <code>ObjectCheck</code> if you want to immediately assign the
 validated value to an instance field or local variable. You can optionally pass a
 function to the <code>ok()</code> method that applies some sort of transformation to
 the validated value:

 <blockquote><pre><code>
 Car car = Check.that(obj).is(instanceOf(), Car.class).ok(Class::cast);
 </code></pre></blockquote></div>
</section>
<section class="summary">
<ul class="summary-list">
<li>
<section class="packages-summary" id="packages-summary">
<!-- ============ PACKAGES SUMMARY =========== -->
<h2>Packages</h2>
<div id="package-summary-table">
<div class="caption"><span>Exports</span></div>
<div class="summary-table two-column-summary">
<div class="table-header col-first">Package</div>
<div class="table-header col-last">Description</div>
<div class="col-first even-row-color package-summary-table package-summary-table-tab1"><a href="org/klojang/check/package-summary.html">org.klojang.check</a></div>
<div class="col-last even-row-color package-summary-table package-summary-table-tab1">
<div class="block">The central package of this Java module.</div>
</div>
<div class="col-first odd-row-color package-summary-table package-summary-table-tab1"><a href="org/klojang/check/aux/package-summary.html">org.klojang.check.aux</a></div>
<div class="col-last odd-row-color package-summary-table package-summary-table-tab1">
<div class="block">A small collection of classes and interfaces that do not themselves take part in
 the validation framework, but are treated as first-class citizens by it.</div>
</div>
<div class="col-first even-row-color package-summary-table package-summary-table-tab1"><a href="org/klojang/check/fallible/package-summary.html">org.klojang.check.fallible</a></div>
<div class="col-last even-row-color package-summary-table package-summary-table-tab1">
<div class="block">A collection of functional interfaces that allow a checked exception to be thrown
 from their functional method.</div>
</div>
<div class="col-first odd-row-color package-summary-table package-summary-table-tab1"><a href="org/klojang/check/relation/package-summary.html">org.klojang.check.relation</a></div>
<div class="col-last odd-row-color package-summary-table package-summary-table-tab1">
<div class="block">A collection of functional interfaces that together constitute one category of
 checks that can be executed using Klojang Check.</div>
</div>
</div>
</div>
</section>
</li>
</ul>
</section>
</main>
<footer role="contentinfo">
<hr>
<p class="legal-copy"><small>Copyright &#169; 2022 <a href="http://www.naturalis.nl">Naturalis Biodiversity Center</a>. All rights reserved.</small></p>
</footer>
</div>
</div>
</body>
</html>
